---
title: "GSE80080"
output: html_document
date: "2023-09-15"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Analysis of microarray data from GSE80080

```{r}
library(limma)
library(knitr)
library("illuminaio")

bgxfile = dir(path="./", pattern="bgx")
idatfiles = dir(path="./GSE80080_RAW", pattern=".idat", full.names = T)
# idatfiles = idatfiles[-4] # removing RXF2
data = read.idat(idatfiles, bgxfile)
data$other$Detection <- detectionPValues(data)

```




```{r}
pe = propexpr(data)
kable(pe, "markdown") # proprotion of probes being detected as expressed, should be consistent
```




```{r}
data.norm = neqc(data) # normalize data
# table(apply(data.norm$other$Detection, 1, function(x){all(x < 0.05)}))

data.norm

```


```{r}
eset = data.norm$E
distance = dist(t(eset))#,method="maximum")
clusters = hclust(distance, method="ward.D")
plot(clusters) 
```


```{r}
sampledata = data.frame(geo=c("GSM2112539", "GSM2112540", "GSM2112541", "GSM2112542", "GSM2112543", "GSM2112544"),
						name = c("SKR_1", "RXF_1", "SKR_2", "RXF_2", "SKR_3", "RXF_3"),
						condition = c("SKR", "RXF", "SKR", "RXF", "SKR", "RXF")
						)

#without RXF 2
# sampledata = data.frame(geo=c("GSM2112539", "GSM2112540", "GSM2112541", "GSM2112543", "GSM2112544"),
# 						name = c("SKR_1", "RXF_1", "SKR_2", "SKR_3", "RXF_3"),
# 						condition = c("SKR", "RXF", "SKR", "SKR", "RXF")
# 						)
```


```{r}
library(ggplot2)

pca = prcomp(t(eset))
percentVar <- round(100*pca$sdev^2/sum(pca$sdev^2))
data = as.data.frame(pca$x)
data$name = sampledata$name
data$condition = sampledata$condition
ggplot(data, aes(PC1, PC2, colour=condition)) + geom_point(size=3) +
  scale_x_continuous(paste0("PC1: ",percentVar[1],"% variance"), limits=c(-45, 45))  + 
  scale_y_continuous(paste0("PC2: ",percentVar[2],"% variance"), limits=c(-45, 45)) +
  coord_fixed() + theme_classic() + geom_text(data = data, aes(PC1,PC2, label = name), hjust = 1.2)
```


```{r}
condition <- factor(sampledata$condition, unique(sampledata$condition))
design <- model.matrix(~0 + condition)
colnames(design) <- c("SKR", "RXF")
head(design) # design matrix: ???
```



```{r without unexpressed probes}

# table(apply(data.norm$other$Detection, 1, function(x){any(x < 0.05)})) # how many are expressed

# data.norm.filtered = data.norm[apply(data.norm$other$Detection, 1, function(x){any(x < 0.05)}),] # expressed in any sample
data.norm.filtered = data.norm[(rowSums(data.norm$other$Detection < 0.05) >= 3),] # expressed in at least 3 samples

```

```{r without the probes without genes}
table(table(data.norm$genes$Symbol))

 
empty_probes = c(which(data.norm.filtered$genes$Symbol == ""), which(data.norm.filtered$genes$Symbol == " "), which(is.na(data.norm.filtered$genes$Symbol)))
data.norm.filtered$genes = data.norm.filtered$genes[-empty_probes,]
nrow(data.norm.filtered$genes)

data.norm.filtered$E = data.norm.filtered$E[rownames(data.norm.filtered$E) %in% data.norm.filtered$genes$Array_Address_Id,]
nrow(data.norm.filtered$E) # 18533

# remove_empty_probes <- function(E, genes){
#   
#   print(dim(E))
#   E_remove = c()
#   for (i in seq(length(rownames(E)))){
#     if (!(rownames(E)[i] %in% genes$Array_Address_Id)){
#       E_remove = c(E_remove, i)
#     }
#   }
#   E = E[-E_remove,]
#   print(dim(E))
#   return(E)
# }
# 
# data.norm.filtered$E = remove_empty_probes(data.norm.filtered$E, data.norm.filtered$genes)
# nrow(data.norm.filtered) # 18533




```

```{r without redundant probes}

#n
# empty_probes = c(which(data.norm.filtered$genes$Symbol == ""), which(data.norm.filtered$genes$Symbol == " "), which(is.na(data.norm.filtered$genes$Symbol)))
# x = data.norm.filtered$genes[-empty_probes,]

widest_range_access = c()
all_repeat_access_ids = c() # all access IDs associated with repeated genes 
for (i in unique(data.norm.filtered$genes$Symbol[which(duplicated(data.norm.filtered$genes$Symbol))])) {
  quartile_range = c()
  access_id = as.character(data.norm.filtered$genes$Array_Address_Id[data.norm.filtered$genes$Symbol == i]) # collect access IDs of those with multiple gene symbols
  all_repeat_access_ids = c(all_repeat_access_ids, access_id)
  for (t in access_id){ # for every probe, calculate the interquartile range
    quartile_range = c(quartile_range, abs(summary(data.norm.filtered$E[t,])[5] - summary(data.norm.filtered$E[t,])[2]))
  }
  widest_range_access = c(widest_range_access, access_id[which.max(quartile_range)])
}

remove_repeats = all_repeat_access_ids[!(all_repeat_access_ids %in% widest_range_access)]
data.norm.filtered = data.norm.filtered[-(which(rownames(data.norm.filtered) %in% remove_repeats)),]
nrow(data.norm.filtered) #14428

# number of unique genes detected
length(unique(data.norm.filtered$genes$Symbol[data.norm.filtered$genes$Array_Address_Id %in% rownames(data.norm.filtered$E)]))
length(unique(data.norm.filtered$genes$Symbol)) # 14428 genes




```

```{r}
# DE 

fit <- lmFit(data.norm.filtered, design)
contrast.matrix <- makeContrasts(kc_knc = RXF - SKR, levels=design)
kc_fits <- contrasts.fit(fit, contrast.matrix)
kc_ebFit <- eBayes(kc_fits)
results = topTable(kc_ebFit, coef=1, number=nrow(data.norm))
sum(results$P.Value < 0.01) 
# 1196 genes, not accounting for multiple testing (with: all samples, expressed genes at (any < 0.05), no empty probes and repeat probes with lower interquartile range)
# 1527 genes, not accounting for multiple testing (with: all samples, expressed genes in at least 3 samples. no empty probes and repeat probes with lower interquartile range)
# 800 genes, not accounting for multiple testing (with: excluding RXF2, expressed genes at (any < 0.05), no empty probes and repeat probes with lower interquartile range)
# 1079 genes, not accounting for multiple testing (with: excluding RXF2, expressed genes in at least 3 samples. no empty probes and repeat probes with lower interquartile range)



sum(results$P.Value < 0.1) 
# 5102 genes, not accounting for multiple testing (with: all samples, expressed genes at (any < 0.05), no empty probes and repeat probes with lower interquartile range)
# 4930 genes, not accounting for multiple testing (with: all samples, expressed genes in at least 3 samples. no empty probes and repeat probes with lower interquartile range)
# 4401 genes, not accounting for multiple testing (with: excluding RXF2, expressed genes at (any < 0.05), no empty probes and repeat probes with lower interquartile range)
# 4308 genes, not accounting for multiple testing (with: excluding RXF2, expressed genes in at least 3 samples. no empty probes and repeat probes with lower interquartile range)


sum(results$adj.P.Val < 0.1) 
# 299 with: all samples, expressed genes at (any < 0.05), no empty probes and repeat probes with lower interquartile range
# 1655 with: all samples, expressed genes in at least 3 samples, no empty probes and repeat probes with lower interquartile range -- YAY
# 0! with: without RXF2, expressed genes at (any < 0.05), no empty probes and repeat probes with lower interquartile range
# 577 with: all samples, expressed genes in at least 3 samples, no empty probes and repeat probes with lower interquartile range

de_results = results[results$adj.P.Val < 0.1,]
de_up_results = de_results[de_results$logFC > 0,] # upregulated genes
de_down_results = de_results[de_results$logFC < 0,] # downregulated genes

sum(de_results$logFC > 0)
hist(de_results$logFC)


hist(results$P.Value, xlab="pvalue", main="") 
hist(results$adj.P.Val, xlab="pvalue", main="") 

```


```{r}
write.csv(de_results, file = "de_genes_microarray.csv")
```


```{r GSEA of all expressed genes}

library(fgsea)


pathways <- c(gmtPathways("h.all.v2023.1.Hs.symbols.gmt"), gmtPathways("c2.cp.v2023.1.Hs.symbols.gmt")) 


changes_lfc = results$logFC
names(changes_lfc) = results$Symbol

changes_lfc = changes_lfc[order(changes_lfc, decreasing=TRUE)] #ranked list
head(changes_lfc)
head(pathways)

fgseaRes <- fgsea(pathways = pathways, 
                  stats = changes_lfc,
                  minSize=15,
                  maxSize=500) #to generate p-value

head(fgseaRes[order(pval), ], n = 9)
sum(fgseaRes$padj < 0.1)

changing_pathways = fgseaRes[fgseaRes$padj < 0.1,]
changing_pathways$pathway

```

# Pathway 1: Hallmark Epithelial Mesenchymal Transition 

EXPLANATION: 
"Epithelial-mesenchymal transition (EMT) is a biological program whereby epithelial cells acquire mesenchymal phenotype... cancer cells that undergo EMT, apart from invasive, metastatic properties, also exhibit stem cell traits and resistance to programmed cell death...EMT has been linked to tumor aggressiveness and worse clinical features, which is not surprising, since EMT promotes several malignant characteristics including migration and invasion, stemness, metabolic reprogramming, immune evasion and resistance to therapy." (https://link-springer-com.libproxy1.nus.edu.sg/article/10.1007/s11010-023-04670-x)

Cancer cells "lose epithelial characteristics and integrity, acquire mesenchymal features, and become motile" through EMT and fuel invasion of other parts of the body. "EMT is increasingly understood to orchestrate a large variety of complementary cancer features, such as tumor cell stemness, tumorigenicity, resistance to therapy and adaptation to changes in the microenvironment." (https://www-embopress-org.libproxy1.nus.edu.sg/doi/full/10.15252/embj.2021108647)

Notes: No information on how it is related to cachexia? maybe because cachexia occurs in more advanced cancers?
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[1]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[1])

```



# Pathway 2: Hallmark Hypoxia

EXPLANATION: 
"It is thus speculated that during cancer initiation and progression, [Hypoxia-inducible factor 1a] greatly helps pancreatic cells to gain oncogenic properties that allow them to face and overcome the hypoxic conditions, like high proliferative capacity, invasion and metastatic potential...tumor and stromal HIF-1α signaling enhances innate radiation resistance of hypoxic pancreatic tumor cells." (https://www.mdpi.com/2072-6694/2/4/2138)

Hypoxia could stimulate glutamine import, glutamine can be used to fuel proliferation of pancreatic cancer cells (along with glucose). (https://www.mdpi.com/2072-6694/2/4/2138)

"increased HIF-1α in the heart, EDL, soleus, and diaphragm of tumor-bearing mice...  The effect of hypoxia and subsequent increase in HIF-1α in the heart has both beneficial and detrimental effects. Transient hypoxia and induction of HIF-1α have been shown to be cardioprotective in high-altitude training and in myocardial infarction (20, 31, 51). A plausible mechanism for this is that HIF-1α regulates the oxygen consumption of mitochondria, providing protection during hypoxic events and decreased oxygen availability (36)." (https://journals.physiology.org/doi/full/10.1152/ajpheart.00090.2016)
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[2]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[2])

```

# Pathway 3: Hallmark TNFA Signaling via NFKB

EXPLANATION: 
NF-kB is a transcription factor that is activated in response to many things such as pro-inflammatory cytokine, TNFa. TNFa is produced by many cell types such as smooth muscle cells in skeletal muscle and adipocytes. (https://link.springer.com/chapter/10.1007/978-981-13-1435-3_12)

"TNF-α is responsible for the increase in gluconeogenesis, loss of adipose tissue and proteolysis, while causing decrease in protein, lipid and glycogen synthesis...TNF-α increases the corticotrophin-releasing hormone (CRH) level and decreases food intake...NF-kB induced catabolic signaling plays a key role in protein degradation associated with cachexia...TNF-α activates nuclear factor kappa B (NF-κB) which is a primary mediator for the control of transcription and a major applicant for signaling during catabolism. TNF-α rapidly promotes activation of NF-kB in cells of skeletal muscle, including differentiable myotubes and undifferentiable myoblasts...NF-kB affects on the expression of genes which regulate ubiquitin proteasome pathway (UPP) and undoubtedly promotes the loss of protein" (https://www-sciencedirect-com.libproxy1.nus.edu.sg/science/article/pii/S0024320516306853#bb0170)

TNF-a leads to spikes in NF-kB activity leading to prolonged changes in protein levels in muscles (protein loss). (https://respiratory-research.biomedcentral.com/articles/10.1186/rr67)

"NF-κB was activated in muscle progenitors during cachexia, leading to sustained Pax7 expression. In turn, a self-renewing signal in myogenic cells is likely propagated that results in their inability to progress through a differentiation program...activation of NF-κB leading to Pax7 appears crucial in directing proper muscle differentiation at different stages of development and under different environmental conditions." (https://www-ncbi-nlm-nih-gov.libproxy1.nus.edu.sg/pmc/articles/PMC3809785/)
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[3]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[3])

```

# Pathway 4: KEGG Pathways in Cancer

EXPLANATION: 
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[4]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[4])

```


# Pathway 5: NABA Matrisome

EXPLANATION: 
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[5]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[5])

```

# Pathway 6: NABA Matrisome Associated

EXPLANATION: 
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[6]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[6])

```

# Pathway 7: PID FRA Pathway

EXPLANATION: 
"accumulating studies support that increased expression of AP-1 is associated with a variety of human cancers, and AP-1 is actively implicated in tumor progression and development." (https://pubs.acs.org/doi/full/10.1021/jm5004733#)

"After activation, AP-1 regulates the expression of downstream genes involved in various aspects of cancer biology, such as cell growth, apoptosis, angiogenesis, invasion, metastasis and drug resistance." (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10361657/)

Increased Fra-1 in C2C12 mouse muscle cells comes with decreased myosin heavy chain (MyHC) expression. "When we overexpress the Fra-1 subunit in C2C12 cells, we see increased mRNA expression of FAS and caspases 1, 8 and 11 (ortholog of human caspase 4). Caspase 11-mediated activation of caspase 1 appears to activate IL-1β, a catabolism-inducing cytokine implicated in cachexia.  Downstream of Fra-1 expression, we also see increased caspase 3 activity and an increase in the number of TUNEL-positive apoptotic cells... TNFα signaling through the MAPK pathway leads to phosphorylation-dependent stabilization of Fra-1, and leads to a switch to Jun:Fra-1 heterodimer composition which, in turn, transcriptionally up-regulates FAS and caspases 1, 8 and 11." This leads to increased apoptosis. (https://aacrjournals.org/cancerres/article/71/8_Supplement/4786/573579/Abstract-4786-A-role-for-increased-Fra-1)
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[7]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[7])

```

# Pathway 8: WP Adipogenesis

EXPLANATION: 
"Although skeletal muscle atrophy due to increased protein breakdown is known as the major hallmark of CAC, depletion and remodeling of adipose tissue also plays a crucial role in cachectic patients. The mechanism that drives adipose tissue depletion is multifactorial. Lipolysis is activated, accompanied by elevated total energy expenditure and suppressed adipogenesis, eventually reducing the fat mass. Several studies have revealed that adipose tissue wasting typically occurs before the appearance of other classic cachexia signs." (https://www.sciencedirect.com/science/article/pii/S2212877821001575)

Upregulation of adipogenesis inhibitors, coupled with increased lipolysis, leads to decreased fat mass?

"Besides, the extracellular matrix (ECM) plays a crucial role in adipocyte differentiation." --> NABA Matrisome??
"Adipose tissue remodeling is associated with several chronic diseases, including cancer cachexia. These changes comprise morphological and structural modifications characterized by adipocyte atrophy due to impairment of several processes as increased lipid mobilization, enhanced triglyceride lipolysis, reduced lipogenesis, impaired adipogenesis, extracellular matrix (ECM) rearrangement (generally resulting in fibrosis), enhanced inflammation, and adipose tissue “browning”." (https://www.mdpi.com/1422-0067/21/14/4860)
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[8]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[8])

```


# Pathway 9: WP Nuclear Receptors Metapathway

EXPLANATION: 
0 hits for "Nuclear Receptors Metapathway cachexia" search...

Target of NRF2 which is associated with ferroptosis resistance in non-small cell lung carcinoma (https://www.nature.com/articles/s41419-023-06070-x)

"because miRNA genes are transcribed by RNA polymerase II, their expression can be also regulated by nuclear receptors [21]. For example an aberrant expression of nuclear receptors such as estrogen receptor α and androgen receptor in cancer is involved in the deregulation of numerous miRNAs" (https://academic.oup.com/jid/article/212/suppl_1/S74/1052160)
```{r}

plotEnrichment(pathways[[changing_pathways$pathway[9]]], changes_lfc, ticksSize = 1) + labs(title=changing_pathways$pathway[9])

```


```{r ClusterProfiler / GO -- UPREGULATED}

## loading in libraries
library(pheatmap)
library("grid")
# library("gridExtra")
library(cluster)
library(org.Hs.eg.db)
library(clusterProfiler)



rld_up = data.norm.filtered$E[rownames(data.norm.filtered$E) %in% rownames(de_up_results),]
colnames(rld_up) <- sampledata$name
rld_up = rld_up[, c(1,3,5,2,4,6)]
# rld_signif = assay(rld)[rownames(de_up_results),]
rld_z = t(apply(rld_up, 1, function(x){ (x - mean(x)) / sd(x)})) # converting to zscore --> to scale
# Converting the values to z-scores allows us to group the genes by similar pattern of change

#This allows us to get a better understanding of the distribution of patterns of change.   
thr = 3 # threshold on z-score
rld_z[rld_z > thr] = thr # anything greater than 3 --> just 3
rld_z[rld_z < -thr] = -thr # anything less than 3 --> just -3


# elbow criterion - choosing K
set.seed(123)
k.max <- 20 # number of replicates/samples (N = k)
wss <- sapply(2:k.max, 
              function(k){kmeans(rld_z, k, nstart=10,iter.max = 15 )$tot.withinss})
plot(2:k.max, wss,
     type="b", pch = 19, frame = FALSE, 
     xlab="Number of clusters K",
     ylab="Total within-clusters sum of squares",
     xlim = c(0, 20))
# Choosing K: K should be around 4 clusters because this is when the variation 
# accounted for begins to plateau according to the elbow criterion


# How well does each gene belong in its cluster: Silhouette
SIL = sapply(2:20, function(i) { 
  #print(i)
  results.coef.kmeans =  kmeans(rld_z, i, nstart=50, iter.max=50)
    mean(silhouette(results.coef.kmeans$cluster, dist(rld_z))[,3]) }) # average fit of each gene within a cluster
plot(c(0,SIL), type="b") #elbows at around 6, indicating the 6 may be the most appropriate k


# Testing 4 clusters
k = 4
results.coef.kmeans =  kmeans(rld_z, k, nstart=10, iter.max=50)


x = silhouette(results.coef.kmeans$cluster, dist(rld_z))
plot(x, col="black", border=NA, main=paste("k = ", k, collapse = "")) # Silhoutte plot
table(results.coef.kmeans$cluster) # how many genes fit per cluster


## heatmap by cluster
results.coef = rld_z[order(results.coef.kmeans$cluster),] # gets rid of scale, allows us to focus on 
#only the pattern of expression changes
indicator = results.coef.kmeans$cluster[order(results.coef.kmeans$cluster)]
color = c(colorRampPalette(c("mediumblue", "white"))(14), colorRampPalette(c("white", "firebrick2"))(14))
breaksList = seq(-3, 3, length.out = 29)
heat.map <- pheatmap(results.coef, cluster_col=FALSE, breaks=breaksList, 
                     cluster_rows=FALSE, show_rownames=FALSE,color = color,
                     fontsize_row = 3, legend=TRUE,border_color = NA, main = "upregulated genes")
grid.newpage()
grid.draw(heat.map$gtable)


# # get ensemble IDs
# library(biomaRt)
# human = useEnsembl(biomart="ENSEMBL_MART_ENSEMBL",host="https://oct2022.archive.ensembl.org", dataset="hsapiens_gene_ensembl", version=108)
# human = useEnsembl(biomart="ENSEMBL_MART_ENSEMBL",mirror="asia", dataset="hsapiens_gene_ensembl", version="108")
# bm.annotations = getBM(attributes=c("ensembl_gene_id","hgnc_symbol"), mart=human, 
#                        values=data.norm.filtered$genes$Symbol, 
#                        uniqueRows=TRUE)

## Cluster 1
c1 = unique(data.norm.filtered$genes$Symbol[data.norm.filtered$genes$Array_Address_Id %in% names(results.coef.kmeans$cluster[results.coef.kmeans$cluster == 1])]) #171 gene IDs
# c1 = bm.annotations$ensembl_gene_id[bm.annotations$hgnc_symbol %in% c1] #138 ensemble IDs
c1.ensembl = bitr(c1, fromType = "SYMBOL", toType = "ENSEMBL", OrgDb = org.Hs.eg.db)


#GO ontology: does hypergeometric test
ego1 <- enrichGO(gene          = c1, #cluster
                # universe      = de_mirna_targets$Gene.ID, #all genes
                OrgDb         = org.Hs.eg.db, #human
                keyType       = 'SYMBOL', #gene symbol
                ont           = "ALL",
                pAdjustMethod = "BH", #correct for multi testing
                pvalueCutoff  = 1,
                qvalueCutoff  = 0.05)  #threshold)
head(ego1)
dotplot(ego1)
ego.df.1 = as.data.frame(ego1)
heat.map1 <- pheatmap(results.coef[c1_mimat_id,], cluster_col=FALSE, breaks=breaksList, cluster_rows=FALSE, show_rownames=FALSE,color = color,fontsize_row = 3, legend=TRUE,border_color = NA)
grid.newpage()
grid.draw(heat.map1$gtable)



```







How do we get this to be better? (TO DO by Sept 28)
# use this to filter de_mirna_up_targets to only show genes expresed in muscle
# [SKIP] try running this again without RXF 2
# [DONE]filter results df to remove the ones without genes 
# [done I THINK?] filter to use only one probe per gene --> which probe to use? --> pick probe with highest interquartile range (most variable)

TO DO by Oct 5:
# Take ALL EXPRESSED genes and put them in GSEA --> do not use GO and clusterprofiler
# [DONE] remove the probes without expression --> detectionpvalues() --> figure out propexpr cutoff (? 0.05)
# [DONE] try all 3filter steps with and without RXF 2

TO DO by Oct
# Run clusterprofiler & GO on all 
# Look at the different pathways with padj < 0.1 --> vaildate this dataset, is this useful?
  # [DONE] Pathway 1: Hallmark Epithelial Mesenchymal Transition 
  # [DONE] Pathway 2: Hallmark Hypoxia
  # [DONE] Pathway 3: Hallmark TNFA Signaling via NFKB
  # Pathway 4: KEGG Pathways in Cancer
  # Pathway 5: NABA Matrisome
  # Pathway 6: NABA Matrisome Associated
  # [DONE] Pathway 7: PID FRA Pathway
  # [DONE] Pathway 8: WP Adipogenesis
  # [DONE] Pathway 9: WP Nuclear Receptors Metapathway
# run clusterprofiler on up and downregulated genes separately
# filter miRNA de with genes de
  # enrichment analysis, 
  # fold changes of genes, 
  # context score filters


```{r}
sessionInfo()
```